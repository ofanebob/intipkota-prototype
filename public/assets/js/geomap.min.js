function DefaultLoadVenue(a,b,c){c&&(jQuery(b).gmap("clear","markers"),c.clearMarkers()),jQuery(b).gmap("closeInfoWindow"),jQuery.each(a.foursquare,function(a,c){vCategoryLabel=c.venue.categories.length>0?'<span class="label label-primary no-overflow">'+c.venue.categories[0].name+"<span>":"",vCategoryID=c.venue.categories.length>0?c.venue.categories[0].id:0;var d=sitevar.domain+"/public/images/no-image-80x100.jpg";if(c.venue.photos){vPhotos=c.venue.photos;var e=vPhotos.groups;e=e.length>0?e[0].items[0]:null,img=null!=e?e.prefix+"80x100"+e.suffix:d}else img=d;var f={id:c.venue.id,title:c.venue.name,lat:c.venue.location.lat,lng:c.venue.location.lng,address:c.venue.location.formattedAddress.join(", "),categories:{label:vCategoryLabel,id:vCategoryID},image:img},g=c.venue.categories[0].icon.suffix,h=c.venue.categories[0].icon.prefix,i=h+"32"+g;BuildMarkerFoursquare(f,i,"venueMarkerMaps",b)}),c&&BuildMarkerCluster({map:a.map,thisint:b})}function SearchVenue(a,b,c){NProgress.start();var d=c.query.length>0?"query="+c.query+"&":"",e="https://api.foursquare.com/v2/venues/explore?"+d+"ll="+_mapCenter+"&v="+vars.date+"&radius=20000&venuePhotos=1&locale="+sitevar.lang+"&client_id="+vars.clid+"&client_secret="+vars.clsc,f=_mapCenter.split(",");$this=jQuery(b),$this.gmap("closeInfoWindow"),jQuery.getJSON(e).done(function(a){var d=a.response.groups[0].items;if(d.length>0){var e=d.length>=10?{lat:f[0],lng:f[1]}:{lat:d[0].venue.location.lat,lng:d[0].venue.location.lng};$this.gmap("clear","markers"),_markerCluster.clearMarkers(),$this.gmap("option","center",new google.maps.LatLng(e.lat,e.lng)),d.length>=10&&$this.gmap("option","zoom",13),jQuery(b).addClass("filter"),DefaultLoadVenue({foursquare:d},b),BuildMarkerCluster({map:c.map,thisint:b}),BuildListsVenue(d),NProgress.done()}else jQuery.notify('Venue "'+c.query+'" Tidak Ditemukan',{pos:"bottom-right",status:"danger"}),NProgress.done()}).fail(function(){jQuery.notify('Gagal Loading Venue "'+c.query+'"',{pos:"bottom-right",status:"danger"}),NProgress.done()})}function BuildMarkerCluster(a){var b=jQuery(a.thisint).gmap("get","markers");_markerCluster=a.markerCluster?a.markerCluster:new MarkerClusterer(a.map,b,{minimumClusterSize:5,styles:MarkerStyles}),jQuery(a.thisint).gmap("set","MarkerClusterer",_markerCluster)}function BuildOpenWindow(a,b,c){var d='<div id="'+b.id+'" class="WindowMap inner-separator"><div class="innerInfoWindows media">';d+='<span class="pull-left">',d+='<img src="'+b.image+'" class="thumbnail nomargin" data-holder-rendered="true" style="width: 80px; height: 100px;" alt="80x100" /></span>',d+='<div class="media-body">',d+='<h4 class="media-heading">'+b.title+"</h4>",d+='<div class="inner-separator">'+b.categories.label+"</div>",d+=b.address,d+="</div></div></div>",jQuery(c).gmap("openInfoWindow",{content:d},a)}function BuildMarkerFoursquare(a,b,c,d){var e={id:[a.id],position:new google.maps.LatLng(a.lat,a.lng),tags:[a.categories.id],title:a.title,optimized:!1,icon:sitevar.domain+"/public/images/map-marker.png"};jQuery(d).gmap("addMarker",e).dblclick(function(){$.fn.geomodal({auto:!0})}).click(function(){BuildOpenWindow(this,a,d)}).mouseout(function(){jQuery(d).gmap("closeInfoWindow")})}function BuildListsVenue(a){var b="32.png";ListVenueHTML='<div class="clearfix">',jQuery.each(a,function(a,c){var d=c.venue;if(d.categories){var e=d.categories;icon=e[0].icon.prefix+b}else icon="https://ss3.4sqi.net/img/categories_v2/none_"+b;fixCanonical="https://foursquare.com/v/"+d.id,nomargin=d.name.length>=27?'class="nomargin"':"",ListVenueHTML+='<div class="media foursquare noborder-last-bottom border-smoke border-bottom border-1px border-solid">',ListVenueHTML+='<a data-geocode="'+d.location.lat+","+d.location.lng+'" class="pull-left thumbnail quick-venue-map" id="'+d.id+'" title="'+htmlentities(d.name)+'" href="'+fixCanonical+'" target="_blank">',ListVenueHTML+='<img src="'+icon+'" class="waitForImages bg-primary" data-holder-rendered="true" style="width: 32px; height: 32px;" alt="32x32" />',ListVenueHTML+="</a>",ListVenueHTML+='<div class="media-body">',ListVenueHTML+='<div class="media-heading">',ListVenueHTML+="<h5 "+nomargin+">",ListVenueHTML+='<a data-geocode="'+d.location.lat+","+d.location.lng+'" id="'+d.id+'" class="quick-venue-map d-inline-block w-100cent" title="'+htmlentities(d.name)+'" href="'+fixCanonical+'" target="_blank">',ListVenueHTML+=d.name.substr(0,1).toUpperCase()+d.name.substring(1),ListVenueHTML+="</a>",ListVenueHTML+="</h5>",ListVenueHTML+="</div>",ListVenueHTML+="</div>",ListVenueHTML+="</div>"}),ListVenueHTML+="</div>",jQuery("div#scollVenue").html(ListVenueHTML)}var MarkerStyles=[{height:53,url:sitevar.domain+"/public/images/m1.png",width:53},{height:56,url:sitevar.domain+"/public/images/m2.png",width:56},{height:66,url:sitevar.domain+"/public/images/m3.png",width:66},{height:78,url:sitevar.domain+"/public/images/m4.png",width:78},{height:90,url:sitevar.domain+"/public/images/m5.png",width:90}],TopNavbar=jQuery("#TopNavbar").height(),windowsHeight=Math.round(jQuery(window).height()-(TopNavbar+2)),CanvasDOM="#MapCanvas",geoLat=geolocation.lat,geoLng=geolocation.lng,_mapCenter=geoLat+","+geoLng,f=foursquare,TotalVenue=f.filter(function(a){return void 0!==a}).length,DynamicZoom=Math.round(20-20*TotalVenue/100/3.5),_map=null,_markerCluster=null;jQuery(document).ready(function(){var a='<div id="resetMapsDOM"><i class="glyphicon glyphicon-refresh v-align-middle"></i></div>';jQuery(CanvasDOM).css({height:windowsHeight}).gmap({disableDefaultUI:!0,center:_mapCenter,zoom:DynamicZoom,styles:[{stylers:[{gamma:.75},{lightness:-5},{saturation:20}]}]}).bind("init",function(b,c){thisInit=this,jQuery(this).gmap("clear","markers"),DefaultLoadVenue({foursquare:f},CanvasDOM);var d=jQuery(this).gmap("get","markers");_map=c,_markerCluster=new MarkerClusterer(_map,d,{minimumClusterSize:5,styles:MarkerStyles}),BuildMarkerCluster({map:_map,markerCluster:_markerCluster}),jQuery(a).css({position:"absolute",top:"0px",right:"0px","z-index":"20099",margin:"10px",cursor:"pointer","font-size":"18px",padding:"5px 6px","border-radius":"50%","line-height":"1"}).addClass("text-white bg-primary border-solid border-white border-3px border-all").prependTo(this),jQuery("#resetMapsDOM").bind("click",function(){$this=jQuery(CanvasDOM),jQuery(".glyphicon",this).animateRotate(360,2e3,"linear",function(){}),$this.gmap("option","center",new google.maps.LatLng(geoLat,geoLng)),$this.gmap("option","zoom",DynamicZoom),$this.gmap("closeInfoWindow")})}),jQuery("body").removeAttr("href").css({cursor:"pointer"}).on("click","a.quick-venue-map",function(a){a.preventDefault();var b=jQuery(this).attr("data-geocode"),c=jQuery(this).attr("id"),d=b.split(",");thisLat=d[0],thisLng=d[1],jQuery(CanvasDOM).gmap("find","markers",{property:"id",value:[c],operator:"OR"},function(a,b){b&&(jQuery(CanvasDOM).gmap("option","center",new google.maps.LatLng(thisLat,thisLng)),jQuery(CanvasDOM).gmap("option","zoom",19),jQuery(a).triggerEvent("click"))})}),jQuery("body").on("keyup","input#filtersearchbox",function(a){var b=jQuery(this).val();if(13==a.keyCode)if(b.length>=3)SearchVenue(this,CanvasDOM,{query:jQuery(this).val(),map:_map,styles:MarkerStyles});else{if(b.length>=1&&b.length<=2)return!1;jQuery(CanvasDOM).gmap("option","zoom",DynamicZoom),jQuery(CanvasDOM).gmap("option","center",new google.maps.LatLng(geoLat,geoLng)),jQuery(CanvasDOM).hasClass("filter")&&(jQuery(CanvasDOM).removeClass("filter"),DefaultLoadVenue({foursquare:f,map:_map},CanvasDOM,_markerCluster),BuildListsVenue(f))}})});